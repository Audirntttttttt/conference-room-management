<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <title>掌上智能访客及会议室管理系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=0"
          name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <link rel="stylesheet" href="layui/css/layui.css"/>
    <link rel="stylesheet" href="css/admin.css"/>
    <link rel="stylesheet" type="text/css" media="screen and (max-width:992px)" href="css/admin.mobile.css">
</head>

<style>

</style>


<body>
<!-- 布局容器 -->
<div class="layui-layout layui-layout-admin">

    <!-- 头部 -->
    <div id="header">
        <header-component></header-component>
    </div>

    <!-- 遮罩层 -->
    <div class="masked"></div>

    <!-- 左侧菜单 -->
    <div id="leftSlide">
        <leftslide-component></leftslide-component>
    </div>

    <!-- 主体 -->
    <div class="layui-body" id="app">
        <!-- 主要内容 -->
        <div class="container">
            <!-- 搜索条件 -->
            <div class="search-res-mask"></div>
            <div class="search-res">
                <div class="search-res-btn hide-pc">
                    <button class="layui-btn" id="search-btn"><i class="layui-icon">&#xe615;</i>查询</button>
                </div>
                <div class="content-search search-fix">
                    <div class="layui-form layui-form-pane">
                        <div class="layui-inline">
                            <label class="layui-form-label">姓名</label>
                            <div class="layui-input-inline">
                                <input class="layui-input" name="guestName" placeholder="请输入访客姓名" id="guestName">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">信誉分</label>
                            <div class="layui-input-inline">
                                <input class="layui-input" name="guestCredit" placeholder="请输入访客信誉分" id="guestCredit">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <button class="layui-btn" lay-submit="" id="btnSearch" lay-filter="btnSearch">查询</button>
                            <button class="layui-btn layui-btn-primary hide-pc" id="search-close">关闭</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tar mt10">
                <!-- <a class="layui-btn layui-btn-normal layui-btn-small" href="">+发布商品</a> -->
                <button class="layui-btn layui-btn-normal layui-btn-small export" id="exportExcel">导出</button>
            </div>
            <!-- 表格列表 -->
            <div class="table-list" id="content">
                <table class="layui-table layui-list-table" lay-skin="line" id="test">
                    <thead>
                    <tr>
                        <th>姓名</th>
                        <th>身份证</th>
                        <th>联系方式</th>
                        <th>邮箱</th>
                        <th>单位</th>
                        <th>信誉分</th>
                    </tr>
                    </thead>
                    <tbody id="tableResult">
                    <tr v-for="item in items">
                        <td class="layui-table-first"><span class="layui-table-bd"><a style="color:blue;"
                                                                                      :href="'visitorReserveInfo.html?guestName='+item.guestName+'&&guestId='+item.guestId"
                                                                                      title="查看预约详情">{{item.guestName}}</a></span>
                        </td>
                        <!--<td><i class="layui-table-hd">访客性别</i><span class="layui-table-bd">{{item.guestSex}}</span></td>-->
                        <td><span class="layui-table-bd">{{item.guestId}}</span></td>
                        <td><span class="layui-table-bd">{{item.guestTelephone}}</span></td>
                        <td><span class="layui-table-bd">{{item.guestEmail}}</span></td>
                        <td><span class="layui-table-bd">{{item.guestCompany}}</span></td>
                        <td><span class="layui-table-bd">{{item.guestCredit}}</span></td>
                    </tr>

                    </tbody>
                </table>
                <!-- 加载时候的效果 -->
                <div class="loading">
                    <i class="layui-icon layui-anim layui-anim-rotate layui-anim-loop" style="font-size: 30px;">
                        &#xe63d;</i>
                </div>

                <!-- 分页 -->
                <div id="table-pages" class="tac"></div>

            </div>
        </div>
    </div>
    <!-- 可不引入 -->
    <script type="text/javascript" src="js/vue.min.js"></script>
    <script type="text/javascript" src="layui/layui.js"></script>
    <script type="text/javascript" src="js/fastclick.js"></script>
    <script type="text/javascript" src="js/admin.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/jquery.tabletojson.min.js"></script>
    <script type="text/javascript" src="js/visitorInfo.js"></script>

</body>
<script type="text/javascript">
//    var table = $("#test").tableToJSON();
//    console.log(table);
    //导出excel
    function exportExcel(fileName, tableId) {
        var table = $("#" + tableId).tableToJSON();
        console.log(table);
        // debugger;
        var json = JSON.stringify(table);
        var nodes = $("#" + tableId + " thead tr").children();
        var headers = "";
        $.each(nodes, function (i, item) {
            headers += item.innerHTML + ",";
        })
        //调用post方法
        post('http://47.94.206.242/meet/admin/getExcel.action', {fileName: fileName, headers: headers, json: json});
    }

    //post方法s
    function post(url, params) {
        var temp = document.createElement("form");
        temp.action = url;
        temp.method = "post";
        temp.style.display = "none";
        for (var x in params) {
            var opt = document.createElement("input");
            opt.name = x;
            opt.value = params[x];
            temp.appendChild(opt);
        }
        document.body.appendChild(temp);
        temp.submit();
        return temp;
    }

    $("#exportExcel").click(function () {

        exportExcel('guestinfo', 'test');
    })
</script>
</html>